TY.loadedModule("TY.util.scrollbar"),function(t){"use strict";function o(o,n){function s(){return S.update(),h(),S}function c(){f.css(g,S.thumbPosition),v.css(g,-S.contentPosition),w.css(P,S.trackSize),b.css(P,S.trackSize),f.css(P,S.thumbSize)}function h(){z?p[0].ontouchstart=function(t){1===t.touches.length&&(t.stopPropagation(),l(t.touches[0]))}:(f.bind("mousedown",function(t){t.stopPropagation(),l(t)}),b.bind("mousedown",function(t){l(t,!0)})),t(window).resize(function(){S.update("relative")}),S.options.wheel&&window.addEventListener?o[0].addEventListener(T,u,!1):S.options.wheel&&(o[0].onmousewheel=u)}function r(){return S.contentPosition>0}function a(){return S.contentPosition<=S.contentSize-S.viewportSize-5}function l(o,e){S.hasContentToSroll&&(t("body").addClass("noSelect"),I=e?f.offset()[g]:k?o.pageX:o.pageY,z?(document.ontouchmove=function(t){(S.options.touchLock||r()&&a())&&t.preventDefault(),d(t.touches[0])},document.ontouchend=m):(t(document).bind("mousemove",d),t(document).bind("mouseup",m),f.bind("mouseup",m),b.bind("mouseup",m)),d(o))}function u(e){if(S.hasContentToSroll){var i=e||window.event,n=-(i.deltaY||i.detail||-1/3*i.wheelDelta)/40,s=1===i.deltaMode?S.options.wheelSpeed:1;S.contentPosition-=n*s*S.options.wheelSpeed,S.contentPosition=Math.min(S.contentSize-S.viewportSize,Math.max(0,S.contentPosition)),S.thumbPosition=S.contentPosition/S.trackRatio,o.trigger("move"),f.css(g,S.thumbPosition),v.css(g,-S.contentPosition),(S.options.wheelLock||r()&&a())&&(i=t.event.fix(i),i.preventDefault())}}function d(t){if(S.hasContentToSroll){var e=k?t.pageX:t.pageY,i=z?I-e:e-I,n=Math.min(S.trackSize-S.thumbSize,Math.max(0,S.thumbPosition+i));S.contentPosition=n*S.trackRatio,o.trigger("move"),f.css(g,n),v.css(g,-S.contentPosition)}}function m(){S.thumbPosition=parseInt(f.css(g),10)||0,t("body").removeClass("noSelect"),t(document).unbind("mousemove",d),t(document).unbind("mouseup",m),f.unbind("mouseup",m),b.unbind("mouseup",m),document.ontouchmove=document.ontouchend=null}this.options=t.extend({},i,n),this._defaults=i,this._name=e,o.contents().wrapAll(['<div class="TUI-ScrollContainer">','<div class="TUI-ScrollViewport"><div class="TUI-ScrollOverview"></div></div>','<div class="TUI-ScrollBar"><div class="TUI-ScrollBar-track"><div class="TUI-ScrollBar-thumb"></div></div></div>',"</div>"].join(""));var S=this,p=o.find(".TUI-ScrollViewport"),v=o.find(".TUI-ScrollOverview"),w=o.find(".TUI-ScrollBar"),b=w.find(".TUI-ScrollBar-track"),f=w.find(".TUI-ScrollBar-thumb"),z="ontouchstart"in document.documentElement,T="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",k="x"===this.options.axis,P=k?"width":"height",g=k?"left":"top",I=0;return t("head").append(t(['<style type="text/css">',".noSelect{user-select:none; -webkit-user-select:none; -moz-user-select:none; -o-user-select:none; -khtml-user-select:none;}",".scrollbarHidden{display:none;}",".TUI-ScrollContainer{width:100%; height:100%; position:relative; *zoom:1;}",".TUI-ScrollViewport{width:100%; height:100%; overflow:hidden; position:relative; *zoom:1;}",".TUI-ScrollOverview{position:absolute; left:0; top:0;}",".TUI-ScrollBar{position:absolute; "+(k?"left;0; bottom:0;":"top:0; right:0;")+"}",".TUI-ScrollBar-track{width:100%; height:100%; position:relative; *zoom:1;}",".TUI-ScrollBar-thumb{width:100%; height:100%; position:absolute; left:0; top:0; cursor:pointer; overflow:hidden;}","</style>"].join(""))),this.contentPosition=0,this.viewportSize=0,this.contentSize=0,this.contentRatio=0,this.trackSize=0,this.trackRatio=0,this.thumbSize=0,this.thumbPosition=0,this.hasContentToSroll=!1,this.update=function(t){var o=P.charAt(0).toUpperCase()+P.slice(1).toLowerCase();switch(this.viewportSize=p[0]["offset"+o],this.contentSize=v[0]["scroll"+o],this.contentRatio=this.viewportSize/this.contentSize,this.trackSize=this.options.trackSize||this.viewportSize,this.thumbSize=Math.min(this.trackSize,Math.max(this.options.thumbSizeMin,this.options.thumbSize||this.trackSize*this.contentRatio)),this.trackRatio=(this.contentSize-this.viewportSize)/(this.trackSize-this.thumbSize),this.hasContentToSroll=this.contentRatio<1,w.toggleClass("scrollbarHidden",!this.hasContentToSroll),t){case"bottom":this.contentPosition=Math.max(this.contentSize-this.viewportSize,0);break;case"relative":this.contentPosition=Math.min(Math.max(this.contentSize-this.viewportSize,0),Math.max(0,this.contentPosition));break;default:this.contentPosition=parseInt(t,10)||0}return this.thumbPosition=this.contentPosition/this.trackRatio,c(),S},s()}var e="scrollbar",i={axis:"y",wheel:!0,wheelSpeed:40,wheelLock:!0,touchLock:!0,trackSize:!1,thumbSize:!1,thumbSizeMin:20};t.fn[e]=function(i){return this.each(function(){t.data(this,"TY_util_"+e)||t.data(this,"TY_util_"+e,new o(t(this),i))})}}(jQuery);